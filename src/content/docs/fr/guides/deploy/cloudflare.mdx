---
title: D√©ployez votre site Astro sur les pages Cloudflare
description: Comment d√©ployer votre site Astro sur le web en utilisant les pages Cloudflare.
type: deploy
i18nReady: true
---

Vous pouvez d√©ployer votre projet Astro sur [Cloudflare Pages](https://pages.cloudflare.com/), une plateforme permettant aux d√©veloppeurs frontaux de collaborer et de d√©ployer des sites web statiques (JAMstack) et SSR.

Ce guide comprend :

- [Comment d√©ployer via le Cloudflare Pages Dashboard](#comment-d√©ployer-un-site-avec-git)
- [Comment d√©ployer un site en utilisant Wrangler, la CLI de Cloudflare](#comment-d√©ployer-un-site-√†-laide-de-wrangler)
- [Comment d√©ployer un site SSR en utilisant `@astrojs/cloudflare`](#comment-d√©ployer-un-site-ssr)

## Pr√©-requis

Pour commencer, vous aurez besoin :

- Un compte Cloudflare. Si vous n'en avez pas encore, vous pouvez cr√©er un compte Cloudflare gratuit au cours de la proc√©dure.
- Le code de votre application pouss√© sur un d√©p√¥t [GitHub](https://github.com/) ou [GitLab](https://about.gitlab.com/).

## Comment d√©ployer un site avec Git

1. Cr√©ez un nouveau projet sur Cloudflare Pages.
2. Poussez votre code dans votre d√©p√¥t Git (GitHub, GitLab).
3. Connectez-vous au tableau de bord de Cloudflare et s√©lectionnez votre compte dans **Comptes** > **Workers et Pages**.
4. S√©lectionnez **Cr√©er une application**, naviguez dans l'onglet **Pages** et cliquez sur **Se connecter √† Git**.
5. S√©lectionnez le projet git que vous souhaitez d√©ployer et cliquez sur **Commencer la configuration**.
6. Utilisez les param√®tres de construction suivants :

 - **Framework preset**: `Astro`
 - **Build command:** `npm run build`
 - **Build output directory:** `dist`

7. Cliquez sur le bouton **Enregistrer et d√©ployer**.

## Comment d√©ployer un site √† l'aide de Wrangler

1. Installez [Wrangler CLI](https://developers.cloudflare.com/workers/wrangler/get-started/).
2. Authentifiez Wrangler avec votre compte Cloudflare en utilisant `wrangler login`.
3. Lancez votre commande de construction.
4. D√©ployez en utilisant `npx wrangler pages deploy dist`.

```bash
# Installez Wrangler CLI
npm install -g wrangler
# Connectez-vous √† votre compte Cloudflare depuis le CLI
wrangler login
# Ex√©cutez votre commande de build
npm run build
# Cr√©er un nouveau d√©ploiement
npx wrangler pages deploy dist
```

Une fois vos ressources t√©l√©charg√©es, Wrangler vous donnera une URL de pr√©visualisation pour inspecter votre site. Lorsque vous vous connectez au tableau de bord de Cloudflare Pages, vous verrez votre nouveau projet.

### Activer la pr√©visualisation localement avec Wrangler

Pour que la pr√©visualisation fonctionne, vous devez installer `wrangler`

```bash
pnpm install wrangler --save-dev
```

Il est alors possible de mettre √† jour le script de pr√©visualisation pour ex√©cuter `wrangler` au lieu de la commande de pr√©visualisation int√©gr√©e √† Astro :


```json title="package.json"
"preview" : "wrangler pages dev ./dist"
```

## Comment d√©ployer un site SSR

Vous pouvez construire un site Astro SSR pour le d√©ployer sur Cloudflare Pages en utilisant l'adaptateur [`@astrojs/cloudflare`](/fr/guides/integrations-guide/cloudflare/).

Suivez les √©tapes ci-dessous pour configurer l'adaptateur. Vous pouvez ensuite d√©ployer en utilisant l'une ou l'autre des approches document√©es ci-dessus.

### Installation rapide

Ajoutez l'adaptateur Cloudflare pour activer SSR dans votre projet Astro avec la commande `astro add` suivante. Cela installera l'adaptateur et apportera les changements appropri√©s √† votre fichier `astro.config.mjs` en une seule √©tape.

```bash
npx astro add cloudflare
```

### Installation manuelle

Si vous pr√©f√©rez installer l'adaptateur manuellement, suivez les deux √©tapes suivantes :

1. Ajoutez l'adaptateur `@astrojs/cloudflare` aux d√©pendances de votre projet en utilisant votre gestionnaire de paquets pr√©f√©r√©. Si vous utilisez npm ou si vous n'√™tes pas s√ªr, lancez ceci dans le terminal :

 ```bash
 npm install @astrojs/cloudflare
 ```

2. Ajoutez ce qui suit √† votre fichier `astro.config.mjs` :

 ```js title="astro.config.mjs" ins={2, 5-6}
 import { defineConfig } from 'astro/config' ;
 import cloudflare from '@astrojs/cloudflare' ;

 export default defineConfig({
   output : 'server',
   adapter : cloudflare()
 }) ;
    ```

### Les modes

Il existe actuellement deux modes d'utilisation de Pages Functions avec l'adaptateur [`@astrojs/cloudflare`](https://github.com/withastro/astro/tree/main/packages/integrations/cloudflare#readme).

1. Mode **Avanc√©** : Ce mode est utilis√© lorsque vous voulez ex√©cuter votre fonction en mode "avanc√©" qui r√©cup√®re le `_worker.js` dans `dist`, ou en mode r√©pertoire o√π les pages compileront le worker √† partir d'un dossier de fonctions √† la racine du projet.

Si aucun mode n'est d√©fini, la valeur par d√©faut est "advanced".

2. Mode **directory** : Ce mode est utilis√© lorsque vous voulez ex√©cuter votre fonction en mode "r√©pertoire", ce qui signifie que l'adaptateur compilera la partie client de votre application de la m√™me mani√®re, mais il d√©placera le script worker dans un dossier `functions` √† la racine du projet. L'adaptateur ne placera jamais qu'un `[[path]].js` dans ce dossier, ce qui vous permet d'ajouter des plugins et des pages middleware suppl√©mentaires qui peuvent √™tre v√©rifi√©s dans le contr√¥le de version.

 ```ts title= "astro.config.mjs" "directory"
 export default defineConfig({
   adapter : cloudflare({ mode : "directory" }),
 }) ;
    ```
### Utilisation de Pages Functions

Les [Pages Functions](https://developers.cloudflare.com/pages/platform/functions/) vous permettent d'ex√©cuter du code c√¥t√© serveur afin d'activer des fonctionnalit√©s dynamiques sans avoir recours √† un serveur d√©di√©.

Pour commencer, cr√©ez un r√©pertoire `/functions` √† la racine de votre projet. L'√©criture de vos fichiers Functions dans ce r√©pertoire g√©n√®re automatiquement un Worker avec des fonctionnalit√©s personnalis√©es aux itin√©raires pr√©d√©finis. Pour en savoir plus sur l'√©criture des fonctions, consultez la [documentation Pages Functions](https://developers.cloudflare.com/pages/platform/functions/).

üìö En savoir plus sur [SSR in Astro](/fr/guides/server-side-rendering/).

## D√©pannage

Si vous rencontrez des erreurs, v√©rifiez que la version de `node` que vous utilisez localement (`node -v`) correspond √† la version que vous sp√©cifiez dans la variable d'environnement.

Cloudflare requiert [Node v16.13](https://miniflare.dev/get-started/cli#installation), qui est une version plus r√©cente que la version minimale d'Astro, donc v√©rifiez que vous utilisez au moins v16.13.

L'hydratation c√¥t√© client peut √©chouer √† cause du param√®tre Auto Minify de Cloudflare. Si vous voyez `Hydration completed but contains mismatches` dans la console, assurez-vous de d√©sactiver Auto Minify dans les param√®tres de Cloudflare.

---
title: Refer√™ncia da API
i18nReady: true
---
import Since from '~/components/Since.astro';
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro';


## Global `Astro`

A global `Astro` est√° dispon√≠vel em todos os contextos em arquivos `.astro`. Ela tem as seguintes fun√ß√µes:

### `Astro.glob()`

`Astro.glob()` √© uma forma de carregar v√°rios arquivos locais em seu site est√°tico.

```astro
---
// src/components/meu-componente.astro
const postagens = await Astro.glob('../pages/postagens/*.md'); // retorna um array de postagens que est√£o em ./src/pages/postagens/*.md
---

<div>
{postagens.slice(0, 3).map((postagem) => (
  <article>
    <h2>{postagem.frontmatter.titulo}</h2>
    <p>{postagem.frontmatter.descricao}</p>
    <a href={postagem.url}>Leia mais</a>
  </article>
))}
</div>
```

`.glob()` recebe apenas um par√¢metro: uma URL relativa dos arquivos locais que voc√™ gostaria de importar. Ela √© ass√≠ncrona e retorna um array das exporta√ß√µes dos arquivos correspondentes.

`.glob()` n√£o pode receber vari√°veis ou strings que s√£o interpoladas j√° que n√£o s√£o estaticamente analis√°veis. (Veja [o guia de solu√ß√£o de problemas](/pt-br/guides/troubleshooting/#valores-suportados) para uma solu√ß√£o alternativa.) Isso acontece pois `Astro.glob()` √© feito em cima do [`import.meta.glob()`](https://vitejs.dev/guide/features.html#glob-import) do Vite.

:::note
Voc√™ tamb√©m pode usar `import.meta.glob()` em si em seu projeto Astro. Voc√™ pode querer fazer isso quando:
- Voc√™ precisa dessa funcionalidade em um arquivo que n√£o √© `.astro`, como uma rota de API. `Astro.glob()` √© apenas dispon√≠vel em arquivos `.astro`, enquanto `import.meta.glob()` est√° dispon√≠vel em qualquer parte do projeto.
- Voc√™ n√£o quer carregar cada arquivo imediatamente. `import.meta.glob()` pode retornar fun√ß√µes que importam o conte√∫do do arquivo, ao inv√©s de retornar o conte√∫do em si. Note que essa importa√ß√£o inclui todos os estilos e scripts para quaisquer arquivos importados. Eles v√£o ser empacotados e adicionados para a p√°gina sendo o arquivo usado ou n√£o, j√° que isso √© decidido por an√°lise est√°tica e n√£o em tempo de execu√ß√£o.
- Voc√™ quer acessar o caminho de cada arquivo. `import.meta.glob()` retorna um map do caminho do arquivo ao seu conte√∫do, enquanto `Astro.glob()` retorna uma lista de conte√∫do.
- Voc√™ quer passar m√∫ltiplos padr√µes; por exemplo, voc√™ quer adicionar um "padr√£o negativo" que remove certos arquivos filtrados. `import.meta.glob()` pode opcionalmente receber um array de strings blog, ao inv√©s de uma √∫nica string.

Leia mais sobre na [documenta√ß√£o do Vite](https://vitejs.dev/guide/features.html#glob-import).
:::
#### Arquivos Markdown

Arquivos Markdown tem a seguinte interface:

```ts
export interface MarkdownInstance<T extends Record<string, any>> {
  /* Quaisquer dados especificados no frontmatter YAML deste arquivo */
	frontmatter: T;
  /* O caminho do arquivo deste arquivo */
	file: string;
  /* O caminho renderizado deste arquivo */
	url: string | undefined;
  /* Componente Astro que renderiza os conte√∫dos deste arquivo */
	Content: AstroComponent;
  /* Fun√ß√£o que retorna um array de elementos h1...h6 deste arquivo */
	getHeadings(): Promise<{ depth: number; slug: string; text: string }[]>;
}
```

Voc√™ pode opcionalmente oferecer um tipo para a vari√°vel `frontmatter` utilizando um generic do TypeScript.

```astro
---
interface Frontmatter {
  titulo: string;
  descricao?: string;
}
const postagens = await Astro.glob<Frontmatter>('../pages/postagens/*.md');
---

<ul>
  {postagens.map(postagem => <li>{postagem.frontmatter.titulo}</li>)}
</ul>
```

#### Arquivos Astro

Arquivos Astro tem a seguinte interface:

```ts
export interface AstroInstance {
  /* O caminho de arquivo deste arquivo */
  file: string;
  /* A URL para este arquivo (se ele estiver no diret√≥rio pages) */
	url: string | undefined;
	default: AstroComponent;
}
```

#### Outros Arquivos

Outros arquivos podem ter v√°rias diferentes interfaces, mas `Astro.glob()` aceita um generic do TypeScript se voc√™ souber exatamente o que o tipo de um arquivo desconhecido cont√©m.

```ts
---
interface DadosCustomizadosArquivo {
  default: Record<string, any>;
}
const dados = await Astro.glob<DadosCustomizadosArquivo>('../dados/**/*.js');
---
```

### `Astro.props`

`Astro.props` √© um objeto contendo quaisquer valores que foram passados como [atributos do componente](/pt-br/core-concepts/astro-components/#props-do-componente). Componentes de Layout para arquivos `.md` e `.mdx` recebem valores frontmatter como props.

```astro {3}
---
// src/components/Titulo.astro
const { titulo, data } = Astro.props;
---
<div>
    <h1>{titulo}</h1>
    <p>{data}</p>
</div>
```

```astro /titulo=".+"/ /data=".+"/
---
// src/pages/index.astro
import Titulo from '../components/Titulo.astro';
---
<Titulo titulo="Minha Primeira Postagem" data="09 Ago 2022" />
```

üìö Aprenda mais sobre como [Layouts Markdown e MDX](/pt-br/guides/markdown-content/#frontmatter-layout) lidam com props.

üìö Aprenda mais sobre como adicionar [defini√ß√µes de tipo do TypeScript para suas props](/pt-br/guides/typescript/#propriedades-de-componentes).

### `Astro.params`

`Astro.params` √© um objeto que cont√©m os valores de segmentos din√¢micos de rota que correspondem a essa requisi√ß√£o.

Em builds est√°ticas, ele ser√° o `params` retornado por `getStaticPaths()` usado para pr√©-renderizar [rotas din√¢micas](/pt-br/core-concepts/routing/#rotas-din√¢micas).

Em builds SSR, ele pode ser qualquer valor correspondente aos segmentos do caminho no padr√£o da rota din√¢mica.

```astro title="src/pages/postagens/[id].astro"
---
export function getStaticPaths() {
  return [
    { params: { id: '1' } },
    { params: { id: '2' } },
    { params: { id: '3' } }
  ];
}

const { id } = Astro.params;
---
<h1>{id}</h1>
```

Veja tamb√©m: [`params`](#params)

### `Astro.request`

`Astro.request` √© um objeto [Request](https://developer.mozilla.org/pt-BR/docs/Web/API/Request) padr√£o. Ele pode ser utilizado para obter a `url`, `headers`, `method` e at√© mesmo o body de uma requisi√ß√£o.

```astro
<p>Recebido uma requisi√ß√£o {Astro.request.method} para "{Astro.request.url}".</p>
<p>Headers da requisi√ß√£o recebidos: <code>{JSON.stringify(Object.fromEntries(Astro.request.headers))}</code>
```

Veja tamb√©m: [`Astro.url`](#astrourl)

:::note
Com a op√ß√£o padr√£o `output: 'static'`, `Astro.request.url` n√£o cont√©m par√¢metros de pesquisa, como `?foo=bar`, j√° que n√£o √© poss√≠vel determin√°-los com anteced√™ncia durante builds est√°ticas. Por√©m, no modo `output: 'server'`, `Astro.request.url` cont√©m par√¢metros de busca j√° que podem ser determinados pela requisi√ß√£o do servidor.
:::

### `Astro.response`


`Astro.response` √© um objeto `ResponseInit` padr√£o. Ele tem a seguinte estrutura.

 - `status`: O c√≥digo num√©rico do status da resposta, e.x., `200`.
 - `statusText`: A mensagem de status associada com o c√≥digo de status, e.x., `'OK'`
 - `headers`: Uma inst√¢ncia de [`Headers`](https://developer.mozilla.org/en-US/docs/Web/API/Headers) que voc√™ pode usar para definir os cabe√ßalhos HTTP da resposta.

`Astro.response` √© usado para definir o `status`, `statusText` e `headers` para a resposta de uma p√°gina.


```astro
---
if(condicao) {
  Astro.response.status = 404;
  Astro.response.statusText = 'N√£o encontrado';
}
---
```

Ou para definir um header:

```astro
---
Astro.response.headers.set('Set-Cookie', 'a=b; Path=/;');
---
```

### `Astro.cookies`

<Since v="1.4.0" />

`Astro.cookies` cont√©m utilit√°rios para a leitura e manipula√ß√£o de cookies no modo de [renderiza√ß√£o no lado do servidor](/pt-br/guides/server-side-rendering/).

| Nome      | Tipo                                                                                           | Descri√ß√£o                                                                                                                                                                                                                                                                                |
| :-------- | :--------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `get`     | `(key: string) => AstroCookie`                                                                 | Pega o cookie como um objeto [`AstroCookie`](#astrocookie), que cont√©m `value` e fun√ß√µes utilit√°rios para converter o cookie em tipos que n√£o sejam string.                                                                                                                              |
| `has`     | `(key: string) => boolean`                                                                     | Se o cookie existe. Se o cookie foi definido com `Astro.cookies.set()`, ele ir√° retornar true, e caso contr√°rio, ele ir√° checar cookies em `Astro.request`.                                                                                                                              |
| `set`     | `(key: string, value: string \| number \| boolean \| object, options?: CookieOptions) => void` | Define o cookie `key` para o valor dado. Ele tentar√° converter o valor do cookie para uma string. Op√ß√µes providenciam formas de definir [funcionalidades de cookies](https://www.npmjs.com/package/cookie#options-1), como  `maxAge` ou `httpOnly`.                                      |
| `delete`  | `(key: string, options?: CookieDeleteOptions) => void`                                         | Marca o cookie como deletado. Assim que o cookie √© deletado, `Astro.cookies.has()` ir√° retornar `false` e `Astro.cookies.get()` ir√° retornar um [`AstroCookie`](#astrocookie) com o `value` igual a `undefined`. Op√ß√µes permitem definir o `domain` e o `path` do cookie a ser deletado. |
| `headers` | `() => Iterator<string>`                                                                       | Pega os valores de header para `Set-Cookie` que ser√£o enviados com a resposta.                                                                                                                                                                                                           |


#### `AstroCookie`

Pegar um cookie com `Astro.cookies.get()` retorna um tipo `AstroCookie`. Ele tem a seguinte estrutura.

| Nome      | Tipo                        | Descri√ß√£o                                                                                                                   |
| :-------- | :-------------------------- | :-------------------------------------------------------------------------------------------------------------------------- |
| `value`   | `string\| undefined`        | O valor bruto em string do cookie.                                                                                          |
| `json`    | `() => Record<string, any>` | Faz parse do valor do cookie com `JSON.parse()`, retornando um objeto. Joga um erro se o valor do cookie n√£o √© JSON v√°lido. |
| `number`  | `() => number`              | Faz parse do valor do cookie como um Number. Retorna NaN se n√£o for um n√∫mero v√°lido.                                       |
| `boolean` | `() => boolean`             | Converte o valor do cookie para uma boolean.                                                                                |

### `Astro.redirect()`
`Astro.redirect()` permite voc√™ redirecionar para outra p√°gina.
Uma p√°gina (e n√£o um componente filho) precisa retornar (com `return`) o resultado de `Astro.redirect()` para o redirecionamento acontecer.

```astro title="src/pages/conta.astro" {8}
---
import { estaLogado } from '../utils';

const cookie = Astro.request.headers.get('cookie');

// Se o usu√°rio n√£o est√° logado, redireciona ele para a p√°gina de login
if (!estaLogado(cookie)) {
  return Astro.redirect('/login');
}
---
```

### `Astro.canonicalURL`

:::caution[Descontinuado]
Utilize [`Astro.url`](#astrourl) para construir sua pr√≥pria URL can√¥nica.
:::

A [URL can√¥nica][canonical] da p√°gina atual.

### `Astro.url`

<Since v="1.0.0-rc" />

Um objeto [URL](https://developer.mozilla.org/en-US/docs/Web/API/URL) constru√≠do a partir do valor da string URL atual do `Astro.request.url`. √ötil para interagir com propriedades individuais da URL da requisi√ß√£o, como o nome do caminho e origem.

Equivalente a fazer `new URL(Astro.request.url)`.

```astro
<h1>A URL atual √©: {Astro.url}</h1>
<h1>O nome do caminho da URL atual √©: {Astro.url.pathname}</h1>
<h1>A origem da URL atual √©: {Astro.url.origin}</h1>
```

Voc√™ tamb√©m pode usar `Astro.url` para criar novas URLs a passando como um argumento em [`new URL()`](https://developer.mozilla.org/en-US/docs/Web/API/URL/URL).

```astro title="src/pages/index.astro"
---
// Exemplo: Construa uma URL can√¥nica usando seu dom√≠nio em produ√ß√£o
const URLCanonica = new URL(Astro.url.pathname, Astro.site);
// Exemplo: Construa uma URL para tags meta SEO usando seu dom√≠nio atual
const URLImagemSocial = new URL('/imagens/preview.png', Astro.url);
---
<link rel="canonical" href={URLCanonica} />
<meta property="og:image" content={URLImagemSocial} />
```

### `Astro.clientAddress`

<Since v="1.0.0-rc" />

Especifica o [endere√ßo de IP](https://en.wikipedia.org/wiki/IP_address) da requisi√ß√£o. Esta propriedade √© apenas dispon√≠vel ao fazer build para SSR (renderiza√ß√£o no lado do servidor) e n√£o deve ser usado em sites est√°ticos.

```astro
---
const ip = Astro.clientAddress;
---

<div>Your IP address is: <span class="address">{ ip }</span></div>
```

### `Astro.site`

`Astro.site` retorna a `URL` feita a partir do `site` na sua configura√ß√£o do Astro. Se `site` na sua configura√ß√£o do Astro n√£o estiver definido, `Astro.site` n√£o ser√° definido.

### `Astro.generator`

<Since v="1.0.0" />

`Astro.generator` √© uma forma conveniente de adicionar uma tag [`<meta name="generator">`](https://html.spec.whatwg.org/multipage/semantics.html#meta-generator) na sua vers√£o atual do Astro. Ela segue o formato `"Astro v1.x.x"`.

```astro mark="Astro.generator"
<html>
  <head>
    <meta name="generator" content={Astro.generator} />
  </head>
  <body>
    <footer>
      <p>Constru√≠do com <a href="https://astro.build">{Astro.generator}</a></p>
    </footer>
  </body>
</html>
```

### `Astro.slots`

`Astro.slots` cont√©m fun√ß√µes utilit√°rias para modificar os filhos em slots de um componente Astro.

#### `Astro.slots.has()`

**Tipo:** `(slotName: string) => boolean`

Voc√™ pode checar se existe conte√∫do para um nome de slot espec√≠fico com `Astro.slots.has()`. Isso pode ser √∫til quando voc√™ quer envolver conte√∫dos de slots, mas apenas quer renderizar os elementos que os envolvem quando o slot est√° sendo utilizado.

```astro title="src/pages/index.astro"
---
---
<slot />

{Astro.slots.has('mais') && (
  <aside>
    <h2>Mais</h2>
    <slot name="mais" />
  </aside>
)}
```

#### `Astro.slots.render()`

**Tipo:** `(slotName: string, args?: any[]) => Promise<string>`

Voc√™ pode renderizar de forma ass√≠ncrona os conte√∫dos de um slot para uma string de HTML utilizando `Astro.slots.render()`.

```astro
---
const html = await Astro.slots.render('default');
---
<Fragment set:html={html} />
```

:::note
Isso √© para casos de uso avan√ßados! Na maioria das circunst√¢ncias, √© mais simples renderizar os conte√∫dos do slot com [o elemento `<slot />`](/pt-br/core-concepts/astro-components/#slots).
:::

`Astro.slots.render()` opcionalmente aceita um segundo argumento: um array de par√¢metros que ser√£o passados para quaisquer fun√ß√µes filho. Isso pode ser √∫til para componentes utilit√°rios customizados.

Por exemplo, esse componente `<Grito />` converte sua prop `mensagem` para letras mai√∫sculas e o passa como o slot padr√£o:

```astro title="src/components/Grito.astro" "await Astro.slots.render('default', [mensagem])"
---
const mensagem = Astro.props.mensagem.toUpperCase();
let html = '';
if (Astro.slots.has('default')) {
  html = await Astro.slots.render('default', [mensagem]);
}
---
<Fragment set:html={html} />
```

Uma fun√ß√£o de callback passada como filho de `<Grito />` receber√° o par√¢metro `mensagem` em letras mai√∫sculas:

```astro title="src/pages/index.astro"
---
import Grito from "../components/Grito.astro";
---
<Grito mensagem="slots!">
  {(mensagem) => <div>{mensagem}</div>}
</Grito>

<!-- renderizado como <div>SLOTS!</div> -->
```

### `Astro.self`

`Astro.self` permite que componentes Astro sejam recursivamente invocados. Este comportamento te permite renderizar um componente Astro em si mesmo utilizando `<Astro.self>` no template do componente. Isto pode ser √∫til para iterar sobre grandes cole√ß√µes e estruturas de dados aninhadas.

```astro
---
// ListaAninhada.astro
const { itens } = Astro.props;
---
<ul class="lista-aninhada">
  {itens.map((item) => (
    <li>
      <!-- Se houver uma estrutura de dados aninhada n√≥s renderizamos `<Astro.self>` -->
      <!-- e podemos passar props atrav√©s de uma invoca√ß√£o recursiva -->
      {Array.isArray(item) ? (
        <Astro.self items={item} />
      ) : (
        item
      )}
    </li>
  ))}
</ul>
```

Este componente pode ser utilizado assim:

```astro
---
import ListaAninhada from './ListaAninhada.astro';
---
<ListaAninhada itens={['A', ['B', 'C'], 'D']} />
```

E renderizaria HTML assim:

```html
<ul class="lista-aninhada">
  <li>A</li>
  <li>
    <ul class="lista-aninhada">
      <li>B</li>
      <li>C</li>
    </ul>
  </li>
  <li>D</li>
</ul>
```


### `Astro.locals`

`Astro.locals` √© um objeto contendo quaisquer valores do objeto [`context.locals`](#contextlocals) de um middleware. Use isso para acessar dados retornados por um middleware em seus arquivos `.astro`.

```astro title="src/pages/Pedidos.astro"
---
const titulo = Astro.locals.tituloBoasVindas();
const pedidos = Array.from(Astro.locals.pedidos.entries());
---
<h1>{titulo}</h1>
<ul>
    {pedidos.map(pedido => {
        return <li>{/* faz alguma coisa com cada pedido */}</li>
    })}
</ul>
```

### `Astro.preferedLocale`

`Astro.perferedLocale` √© um valor computado que representa o idioma de prefer√™ncia do usu√°rio.

Ele √© computado checando as configura√ß√µes de idioma do seu array `i18n.locales` e os idiomas suportados pelo navegado do usu√°rio atrav√©s do cabe√ßalho `Accept-Language`. Esse valor √© `undefined` se n√£o houver uma correspond√™ncia.

Essa propriedade s√≥ est√° dispon√≠vel ao fazer o build em modo SSR (renderiza√ß√£o do lado do servidor) e n√£o deve ser utilizada em sites est√°ticos.

### `Astro.preferedLocaleList`

`Astro.preferedLocaleList` representa a lista de todos o slocales que s√£o tanto requisitados pelo navegador quanto suportados pelo seu website. Isso produz uma lista de todas as linguagens compat√≠veis entre o seu site e seu visitante.

Se nenhuma das linguagens requesitadas pelo navegador forem encontradas na sua lista de idiomas, ent√£o o valor √© `[]`: voc√™ n√£o suporta nenhum dos idiomas de prefer√™ncia do seu visitante.

Se o navegador n√£o especificar nenhuma linguagem de prefer√™ncia, ent√£o esse valor ser√° igual ao `i18n.locales`: todas os seus idiomas suportados ser√£o considerados igualmente aceit√°veis pelo visitante sem nenhuma prefer√™nca.

Essa propriedade s√≥ est√° dispon√≠vel ao fazer o build em modo SSR (renderiza√ß√£o do lado do servidor) e n√£o deve ser utilizada em sites est√°ticos.

### `Astro.currentLocale`

O idioma computado a partir da URL atual, utilizando a sintaxe definida em sua configura√ß√£o `locales`. Se a URL n√£o incluir um prefixo `/[locale]/`, ent√£o o valor ser√° o padr√£o definido em `i18n.defaultLocale`.

## Contexto de Endpoint

[Fun√ß√µes de Endpoint](/pt-br/core-concepts/endpoints/) recebem um objeto de contexto como primeiro par√¢metro. Ele copia muitas das propriedades da global `Astro`.

```ts title="endpoint.json.ts"
import type { APIContext } from 'astro';

export function GET(context: APIContext) {
  // ...
}
```

### `context.params`

`context.params` √© um objeto que cont√©m os valores de segmentos din√¢micos de rota que correspondem a essa requisi√ß√£o.

Em builds est√°ticas, ele ser√° o `params` retornado por `getStaticPaths()` usado para pr√©-renderizar [rotas din√¢micas](/pt-br/core-concepts/routing/#rotas-din√¢micas).

Em builds SSR, ele pode ser qualquer valor correspondente aos segmentos do caminho no padr√£o da rota din√¢mica.

```ts title="src/pages/postagens/[id].json.ts"
import type { APIContext } from 'astro';

export function getStaticPaths() {
  return [
    { params: { id: '1' } },
    { params: { id: '2' } },
    { params: { id: '3' } }
  ];
}

export function GET({ params }: APIContext) {
	return new Response(
		JSON.stringify({ id: params.id }),
	);
}
```

Veja tamb√©m: [`params`](#params)

### `context.props`

`context.props` √© um objeto que cont√©m quaisquer `props` passadas de `getStaticPaths()`. Por conta de `getStaticPaths()` n√£o ser usado ao fazer build para SSR (renderiza√ß√£o no lado do servidor), `context.props` est√° dispon√≠vel apenas em builds est√°ticas.

```ts title="src/pages/postagens/[id].json.ts"
import type { APIContext } from 'astro';

export function getStaticPaths() {
  return [
    { params: { id: '1' }, props: { autor: 'Blu' } },
    { params: { id: '2' }, props: { autor: 'Erika' } },
    { params: { id: '3' }, props: { autor: 'Matthew' } }
  ];
}

export function GET({ props }: APIContext) {
	return new Response(
		JSON.stringify({ autor: props.autor }),
	);
}
```

Veja tamb√©m: [Passagem de dados com `props`](#passagem-de-dados-com-props)

### `context.request`

Um objeto [Request](https://developer.mozilla.org/pt-BR/docs/Web/API/Request) padr√£o. Ele pode ser utilizado para conseguir a `url`, `headers`, `method` e at√© mesmo body da requisi√ß√£o.

```ts
import type { APIContext } from 'astro';

export function GET({ request }: APIContext) {
  return {
    body: `Ol√° ${request.url}`
  }
}
```

Veja tamb√©m: [Astro.request](#astrorequest)

### `context.cookies`

`context.cookies` cont√©m utilit√°rios para a leitura e manipula√ß√£o de cookies.

Veja tamb√©m: [Astro.cookies](#astrocookies)

### `context.url`

Um objeto [URL](https://developer.mozilla.org/pt-BR/docs/Web/API/URL) constru√≠do do valor string `context.request.url` da URL atual.

Veja tamb√©m: [Astro.url](#astrourl)

### `context.clientAddress`

Especifica o [endere√ßo de IP](https://pt.wikipedia.org/wiki/Endere%C3%A7o_IP) da requisi√ß√£o. Essa propriedade s√≥ est√° dispon√≠vel ao fazer build para SSR (renderiza√ß√£o no lado do servidor) e n√£o deve ser utilizada para sites est√°ticos.

```ts
import type { APIContext } from 'astro';

export function GET({ clientAddress }: APIContext) {
  return new Response(`Seu endere√ßo de IP √©: ${clientAddress}`);
}
```

Veja tamb√©m: [Astro.clientAddress](#astroclientaddress)


### `context.site`

`context.site` retorna uma `URL` feita do `site` na sua configura√ß√£o do Astro. Se for undefined, ela ir√° retornar uma URL gerada a partir de `localhost`.

Veja tamb√©m: [Astro.site](#astrosite)

### `context.generator`

`context.generator` √© uma forma conveniente de indicar a vers√£o do Astro em que seu projeto est√°. Ela segue o formato `"Astro v1.x.x"`.

```ts title="src/pages/informacao-site.json.ts"
import type { APIContext } from 'astro';

export function GET({ generator, site }: APIContext) {
  const body = JSON.stringify({ generator, site });
  return new Response(body);
}
```

Veja tamb√©m: [Astro.generator](#astrogenerator)

### `context.redirect()`

`context.redirect()` retorna um objeto [Response](https://developer.mozilla.org/pt-BR/docs/Web/API/Response) que te permite redirecionar para outra p√°gina. Essa fun√ß√£o est√° dispon√≠vel apenas ao fazer build para SSR (renderiza√ß√£o no lado do servidor) e n√£o deve ser utilizada para sites est√°ticos.

```ts
import type { APIContext } from 'astro';

export function GET({ redirect }: APIContext) {
  return redirect('/login', 302);
}
```

Veja tamb√©m: [Astro.redirect](#astroredirect)

### `context.locals`

`context.locals` √© um objeto usado para armazenar e acessar informa√ß√µes arbitr√°rias durante o ciclo de vida de uma requisi√ß√£o.

Fun√ß√µes de middleware podem ler e escrever valores do `context.locals`:

```ts title="src/middleware.ts"
import type { MiddlewareResponseHandler } from 'astro';

export const onRequest: MiddlewareResponseHandler = ({ locals }, next) => {
  if (!locals.titulo) {
    locals.titulo = "T√≠tulo Padr√£o";
  }
  return next();
}
```

Endpoints de API so podem ler informa√ß√µes do `context.locals`:

```ts title="src/pages/hello.ts"
import type { APIContext } from 'astro';

export function GET({ locals }: APIContext) {
  return new Response(locals.titulo); // "T√≠tulo Padr√£o"
}
```

Veja tamb√©m: [`Astro.locals`](#astrolocals)

## `getStaticPaths()`

Se uma p√°gina utiliza par√¢metros din√¢micos em seu nome de arquivo, tal componente precisar√° exportar uma fun√ß√£o `getStaticPaths()`.

Esta fun√ß√£o √© necess√°ria pois Astro √© um gerador de sites est√°ticos. Isso significa que o seu site inteiro √© constru√≠do previamente. Se Astro n√£o sabe como gerar uma p√°gina em tempo de build, seus usu√°rios n√£o o ir√£o ver quando visitarem o seu site.

```astro
---
export async function getStaticPaths() {
  return [
    { params: { /* obrigat√≥rio */ }, props: { /* opcional */ } },
    { params: { ... } },
    { params: { ... } },
    // ...
  ];
}
---
<!-- O seu template HTML aqui. -->
```

A fun√ß√£o `getStaticPaths()` deve retornar um array de objetos para determinar quais caminhos ser√£o pr√©-renderizados pelo Astro.

Ela tamb√©m pode ser utilizada para endpoints de arquivos est√°ticos para [roteamento din√¢mico](/pt-br/core-concepts/endpoints/#roteamento-din√¢mico-e-a-propriedade-params).

:::caution
A fun√ß√£o `getStaticPaths()` √© executada em seu pr√≥prio escopo isolado unicamente, antes de qualquer p√°gina carregar. Portanto voc√™ n√£o pode referenciar nada de seu escopo parente al√©m de importa√ß√µes de arquivos. O compilador ir√° te avisar se voc√™ quebrar esse requisito.
:::

### `params`

A chave `params` de todos os objetos retornados diz ao Astro quais rotas construir. Os par√¢metros retornados devem ser mapeados de volta para os par√¢metros din√¢micos e rest definidos no caminho de arquivo do seu componente.

`params` s√£o codificados na URL, ent√£o apenas strings s√£o suportadas como valores. O valor para cada objeto `params` deve corresponder aos par√¢metros utilizados no nome da p√°gina.

Por exemplo, suponha que voc√™ tem uma p√°gina em `src/pages/postagens/[id].astro`. Se voc√™ exportar `getStaticPaths` dessa p√°gina e retornar os seguintes caminhos:

```astro
---
export async function getStaticPaths() {
  return [
    { params: { id: '1' } },
    { params: { id: '2' } },
    { params: { id: '3' } }
  ];
}

const { id } = Astro.params;
---
<h1>{id}</h1>
```

Ent√£o Astro ir√° estaticamente gerar `postagens/1,`, `postagens/2`, e `postagens/3` em tempo de build.

### Passagem de Dados com `props`

Para passar dados adicionais para cada p√°gina gerada, voc√™ tamb√©m pode definir um valor a `props` para cada objeto de caminho retornado. Diferente de `params`, `props` n√£o s√£o codificadas na URL, ent√£o n√£o est√£o limitadas a apenas strings.

Por exemplo, supomos que voc√™ gera p√°ginas baseando-se em dados buscados a partir de uma API remota. Voc√™ pode passar o objeto inteiro dos dados para o componente da p√°gina dentro de `getStaticPaths`:

```astro
---
export async function getStaticPaths() {
  const dados = await fetch('...').then(resposta => resposta.json());

  return dados.map((postagem) => {
    return {
      params: { id: postagem.id },
      props: { postagem },
    };
  });
}

const { id } = Astro.params;
const { postagem } = Astro.props;
---
<h1>{id}: {postagem.nome}</h1>
```

Voc√™ tamb√©m pode passar um array normal, que pode ser √∫til quando for gerar ou esbo√ßar uma lista conhecida de rotas.

```astro
---
export async function getStaticPaths() {
  const postagens = [
    {id: '1', categoria: "astro", titulo: "Refer√™ncia da API"},
    {id: '2', categoria: "react", titulo: "Criando um contador com React!"}
  ];
  return postagens.map((postagem) => {
    return {
      params: { id: postagem.id },
      props: { postagem }
    };
  });
}
const {id} = Astro.params;
const {postagem} = Astro.props;
---
<body>
  <h1>{id}: {postagem.titulo}</h1>
  <h2>Categoria: {postagem.categoria}</h2>
</body>
```

Ent√£o Astro ir√° estaticamente gerar `postagens/1` e `postagens/2` em tempo de build utilizando o componente da p√°gina em `pages/postagens/[id].astro`. A p√°gina pode referenciar esses dados utilizando `Astro.props`:

### `paginate()`

Pagina√ß√£o √© um caso de uso comum para websites que Astro nativamente suporta atrav√©s da fun√ß√£o `paginate()`. `paginate()` ir√° automaticamente gerar o array para retornar de `getStaticPaths()` que cria uma URL para cada p√°gina da cole√ß√£o paginada. O n√∫mero da p√°gina ser√° passado como um par√¢metro, e os dados da p√°gina ser√£o passados como a prop `page`.

```js
export async function getStaticPaths({ paginate }) {
  // Carregue seus dados com fetch(), Astro.glob(), etc.
  const resposta = await fetch(`https://pokeapi.co/api/v2/pokemon?limit=150`);
  const resultado = await resposta.json();
  const todosPokemons = resultado.results;

  // Retorna a cole√ß√£o paginada de caminhos para todas as postagens
  return paginate(todosPokemons, { pageSize: 10 });/*-
}

// Se configurado propriamente, a prop page agora tem tudo
// o que voc√™ precisa para renderizar uma √∫nica p√°gina (veja a pr√≥xima se√ß√£o)
const { page } = Astro.props;
```

`paginate()` assume um nome de arquivo `[page].astro` ou `[...page].astro`. O par√¢metro `page` se torna o n√∫mero da p√°gina em sua URL:

- `/postagens/[page].astro` geraria as URLs `/postagens/1`, `/postagens/2`, `/postagens/3`, etc.
- `/postagens/[...page].astro` geraria as URLs `/postagens`, `/postagens/2`, `/postagens/3`, etc.

`paginate()` recebe os seguintes argumentos:
- `pageSize` - O n√∫mero de itens exibidos por p√°gina
- `params` - Envie par√¢metros adicionais para criar rotas din√¢micas
- `props` - Envie props adicionais para serem disponibilizadas em cada p√°gina

#### A prop `page` da pagina√ß√£o

A pagina√ß√£o ir√° passar a prop `page` para cada p√°gina renderizada que representa uma √∫nica p√°gina de dados na cole√ß√£o paginada. Isso inclui dados que voc√™ paginou (`page.data`) assim como metadados para a p√°gina (`page.url`, `page.start`, `page.end`, `page.total`, etc). Estes metadados s√£o √∫teis para coisas como um bot√£o de "Pr√≥xima P√°gina" ou uma mensagem "Mostrando 1-10 de 100".

| Nome               |         Tipo          | Descri√ß√£o                                                                                                                               |
| :----------------- | :-------------------: | :-------------------------------------------------------------------------------------------------------------------------------------- |
| `page.data`        |        `Array`        | Array dos dados retornados de `data()` para a p√°gina atual.                                                                             |
| `page.start`       |       `number`        | √çndice do primeiro item na p√°gina atual, come√ßando em `0` (e.x. se `pageSize: 25`, isso seria `0` na p√°gina 1, `25` na p√°gina 2, etc.). |
| `page.end`         |       `number`        | √çndice do √∫ltimo item na p√°gina atual.                                                                                                  |
| `page.size`        |       `number`        | Quantos itens h√° por p√°gina.                                                                                                            |
| `page.total`       |       `number`        | O n√∫mero total de itens em todas as p√°ginas.                                                                                            |
| `page.currentPage` |       `number`        | O n√∫mero da p√°gina atual, come√ßando por `1`.                                                                                            |
| `page.lastPage`    |       `number`        | O n√∫mero total de p√°ginas.                                                                                                              |
| `page.url.current` |       `string`        | URL da p√°gina atual (√∫til para URLs can√¥nicas)                                                                                          |
| `page.url.prev`    | `string \| undefined` | URL da p√°gina anterior (ser√° `undefined` se estiver na p√°gina 1).                                                                       |
| `page.url.next`    | `string \| undefined` | URL da pr√≥xima p√°gina (ser√° `undefined` se n√£o houverem mais p√°ginas).                                                                  |

## `import.meta`

Todos os m√≥dulos ESM incluem a propriedade `import.meta`. Astro adiciona `import.meta.env` atrav√©s do [Vite](https://pt.vitejs.dev/guide/env-and-mode).

**`import.meta.env.SSR`** pode ser utilizado para saber quando se est√° sendo renderizado no servidor. As vezes voc√™ pode querer uma l√≥gica diferente, por exemplo, para um componente que deve ser apenas renderizado no cliente:

```jsx
export default function () {
  return import.meta.env.SSR ? <div class="spinner"></div> : <ComponenteComplexo />;
}
```

## Imagens (`astro:assets`)

### `getImage()`

:::caution
`getImage()` depende de APIs exclusivas do servidor e faz o build falhar quando utilizado no cliente.
:::

A fun√ß√£o `getImage()` tem a inten√ß√£o de gerar imagens para serem usadas em lugares n√£o diretamente no HTML, por exemplo em uma [Rota de API](/pt-br/core-concepts/endpoints/#endpoints-do-servidor-rotas-de-api). Ela tamb√©m permite que voc√™ crie seu pr√≥prio componente `<Image />` customizado.

`getImage()` recebe um objeto de op√ß√µes com as [mesmas propriedades do componente "Image"](#propriedades) (exceto `alt`).

```astro
---
import { getImage } from "astro:assets";
import meuPlanoDeFundo from "../planoDeFundo.png";

const planoDeFundoOtimizado = await getImage({src: meuPlanoDeFundo, format: 'avif'});
---

<div style={`background-image: url(${planoDeFundoOtimizado.src});`}></div>
```

Ela retorna um objeto com as seguintes propriedades:

```js
{
  options: {...}, // Par√¢metros originais passados
  src: "https://...", // Caminho para a imagem gerada
  attributes: {...}, // Atributos HTML adicionais necess√°rios para renderizar a imagem (width, height, style, etc...)
}
```

## Cole√ß√µes de Conte√∫do (`astro:content`)

<p>
  <Since v="2.0.0" />
</p>

Cole√ß√µes de conte√∫do oferecem APIs para configurar e buscar seus documentos Markdown ou MDX em `src/content/`. Para funcionalidades e exemplos de uso, [veja nosso guia de cole√ß√µes de conte√∫do](/pt-br/guides/content-collections/).

### `defineCollection()`

`defineCollection()` √© um utilit√°rio para configurar uma cole√ß√£o em um arquivo `src/content/config.*`.

```ts
// src/content/config.ts
import { z, defineCollection } from 'astro:content';
const blog = defineCollection({
  type: 'content',
  schema: z.object({
    titulo: z.string(),
    permalink: z.string().optional(),
  }),
});

// Exponha sua cole√ß√£o definida ao Astro
// com a exporta√ß√£o `collections`
export const collections = { blog };
```

Essa fun√ß√£o aceita as seguintes propriedades:

#### `type`

<Since v="2.5" />

**Tipo:** `'content' | 'data'`
**Padr√£o:** `'content'`

O `type` √© uma string que define o tipo das entidades armazenadas dentro de uma cole√ß√£o:

- `'content'` - para formatos de autoria de conte√∫do como Markdown (`.md`), MDX (`.mdx`) ou Markdoc (`.mdoc`)
- `'data'` - para formatos exclusivamente de dados como JSON (`.json`) ou YAML (`.yaml`)

:::tip
Isso significa que cole√ß√µes **n√£o podem** armazenar uma mistura de conte√∫dos e formatos de dados. Voc√™ precisa dividir essas entidades em cole√ß√µes separadas por tipo.
:::

#### `schema`

**Tipo:** `TSchema extends ZodType`

`schema` √© um objeto Zod opcional para configurar o tipo e formato do frontmatter do documento para uma cole√ß√£o. Cada valor do objeto deve utilizar um [validador do Zod](https://github.com/colinhacks/zod).

[Veja o guia de `Cole√ß√µes de Conte√∫do`](/pt-br/guides/content-collections/#definindo-um-esquema-de-cole√ß√£o) para exemplos de uso.

### `reference()`

**Tipo:** `(collection: string) => ZodEffects<ZodString, { collection, id: string } | { collection, slug: string }>`

A fun√ß√£o `reference()` √© usada na configura√ß√£o de conte√∫do para definir uma rela√ß√£o, ou "refer√™ncia", de uma cole√ß√£o com a outra. Ela aceita um nome de cole√ß√£o e valida o(s) identificador(es) de entrada especificados no frontmatter do seu conte√∫do ou arquivo de dados.

Esse exemplo define refer√™ncias de um autor de blog para a cole√ß√£o `autores` e um array de postagens relacionadas na mesma cole√ß√£o `blog`:

```ts
import { defineCollection, reference, z } from 'astro:content';

const blog = defineCollection({
  type: 'content',
  schema: z.object({
    // Referencia um √∫nico autor da cole√ß√£o `autores` pelo `id`
    autor: reference('autores'),
    // Referencia um array de postagens relacionadas da cole√ß√£o `blog` pelo `slug`
    postagensRelacionadas: z.array(reference('blog')),
  })
});

const autores = defineCollection({
  type: 'data',
  schema: z.object({ /* ... */ })
});

export const collections = { blog, autores };
```

[Veja o guia `Cole√ß√µes de Conte√∫do`](/pt-br/guides/content-collections/#definindo-refer√™ncias-de-cole√ß√£o) para um exemplo de uso.

### `getCollection()`

**Tipo:** `(collection: string, filter?: (entry: CollectionEntry<collection>) => boolean) => CollectionEntry<collection>[]`

`getCollection()` √© uma fun√ß√£o que devolve a lista de entradas de cole√ß√µes de conte√∫do por nome de cole√ß√£o.

Ela retorna todos os itens em uma cole√ß√£o por padr√£o, e aceita uma fun√ß√£o `filter` opcional para limitar por propriedades de entradas. Isso te permite buscar apenas alguns itens em uma cole√ß√£o com base no `id`, `slug`, ou valores do frontmatter pelo objeto `data`.

```astro
---
import { getCollection } from 'astro:content';

// Pega todas as entradas de `src/content/blog/`
const todasPostagensBlog = await getCollection('blog');

// Apenas retorna postagens com `draft: true` no frontmatter
const postagensRascunhoBlog = await getCollection('blog', ({ data }) => {
  return data.draft === true;
});
---
```

[Veja a se√ß√£o guia de `getCollection()`](/pt-br/guides/content-collections/#consultando-cole√ß√µes) para exemplos completos de uso.

### `getEntry()`

<p>
  <Since v="2.5.0" />
</p>

**Tipos:**

- `(collection: string, contentSlugOrDataId: string) => CollectionEntry<collection>`
- `({ collection: string, id: string }) => CollectionEntry<collection>`
- `({ collection: string, slug: string }) => CollectionEntry<collection>`

`getEntry()` √© uma fun√ß√£o que recupera uma √∫nica entrada de cole√ß√£o pelo nome da cole√ß√£o e tanto pelo `id` da entrada (para cole√ß√µes `type: 'data'`) ou pelo `slug` da entrada (para cole√ß√µes `type: 'content'`). `getEntry()` tamb√©m pode ser usada para obter entradas referenciadas para acessar as propriedades `data`, `body` ou `render()`:

```astro
---
import { getEntry } from 'astro:content';

// Obt√©m `src/content/blog/empreendimento.md`
const empreendimentoPostagem = await getEntry('blog', 'empreendimento');

// Obt√©m `src/content/capitaes/picard.yaml`
const picardPerfil = await getEntry('capitaes', 'picard');

// Obt√©m o perfil referenciado por `data.capitao`
const empreendimentoCapitaoPerfil = await getEntry(empreendimento.data.capitao);
---
```

Veja o guia `Cole√ß√µes de Conte√∫do` para exemplos de como [consultar entradas de cole√ß√£o](/pt-br/guides/content-collections/#consultando-cole√ß√µes).

### `getEntries()`

<p>
  <Since v="2.5" />
</p>

**Tipos:**

- `(Array<{ collection: string, id: string }>) => CollectionEntry<collection>`
- `(Array<{ collection: string, slug: string }>) => CollectionEntry<collection>`

`getEntries()` √© uma fun√ß√£o que recupera m√∫ltiplas entradas de uma mesma cole√ß√£o. Isso √© √∫til para [retornar um array de entradas referenciadas](/pt-br/guides/content-collections/#definindo-refer√™ncias-de-cole√ß√£o) para acessar as propriedades `data`, `body` e `render()` associadas a elas.

```astro
---
import { getEntries } from 'astro:content';

const empreendimentoPostagem = await getEntry('blog', 'empreendimento');

// Obt√©m postagens relacionadas referenciadas por `data.postagensRelacionadas`
const empreendimentoPostagensRelacionadas = await getEntries(empreendimentoPostagem.data.postagensRelacionadas);
---
```

### `getEntryBySlug()`

**Tipo:** `(collection: string, slug: string) => CollectionEntry<collection>`

:::caution[Descontinuado]
Use a [fun√ß√£o `getEntry()`](#getentry) para consultar entradas de conte√∫do. Ela aceita os mesmos argumentos que `getEntryBySlug()`, e suporta consultar pelo `id` para cole√ß√µes JSON ou YAML.
:::

`getEntry()` √© uma fun√ß√£o que devolve uma √∫nica entrada de cole√ß√£o por nome de cole√ß√£o e `slug` da entrada.


```astro
---
import { getEntryBySlug } from 'astro:content';

const enterprise = await getEntryBySlug('blog', 'enterprise');
---
```

[Veja o guia de `Cole√ß√µes de Conte√∫do`](/pt-br/guides/content-collections/#consultando-cole√ß√µes) para exemplos de uso.

### Tipo da Entrada da Cole√ß√£o

As fun√ß√µes de consulta [`getCollection()`](#getcollection), [`getEntry()`](#getentry) e [`getEntries()`](#getentries) retornam entradas com o tipo `CollectionEntry`. Esse tipo est√° dispon√≠vel como um utilit√°rio de `astro:content`:

```ts
import type { CollectionEntry } from 'astro:content';
```

O tipo `CollectionEntry<TCollectionName>` √© um objeto com os seguintes valores. `TCollectionName` √© o nome da cole√ß√£o que voc√™ est√° consultando (e.x. `CollectionEntry<'blog'>`).

#### `id`

**Dispon√≠vel para:** cole√ß√µes `type: 'content'` e `type: 'data'`
**Tipos de Exemplo:**
  - cole√ß√µes de conte√∫do: `'entrada-1.md' | 'entrada-2.md' | ...`
  - cole√ß√µes de dados: `'autor-1' | 'autor-2' | ...`

Um ID √∫nico utilizando o caminho de arquivo relativo a `src/content/[cole√ß√£o]`. Enumera todos os valores de string poss√≠veis com base nos caminhos de arquivo da entrada de cole√ß√£o. Note que cole√ß√µes [definidas como `type: 'content'`](#type) incluem a extens√£o do arquivo em seus ID, enquanto cole√ß√µes definidas como `type: 'data'` nao incluem.

#### `collection`

**Dispon√≠vel para:** cole√ß√µes `type: 'content'` e `type: 'data'`
**Tipo de Exemplo:** `'blog' | 'autores' | ...`

O nome de uma pasta de n√≠vel superior dentro de `src/content/` onde as entradas s√£o localizadas. Este √© o nome usado para referenciar a cole√ß√£o no seu esquema e em fun√ß√µes de consulta.

#### `data`

**Dispon√≠vel para:** cole√ß√µes `type: 'content'` e `type: 'data'`
**Tipo:** `CollectionSchema<TCollectionName>`

Um objeto de propriedades frontmatter inferidas do schema da sua cole√ß√£o ([veja a refer√™ncia de `defineCollection()`](#definecollection)). Por padr√£o √© `any` se nenhum schema √© configurado.

#### `slug`

**Dispon√≠vel para:** apenas cole√ß√µes `type: 'content'`
**Tipo de Exemplo:** `'entrada-1' | 'entrada-2' | ...`

Uma slug pronta para URLs para documentos Markdown ou MDX. Por padr√£o √© o `id` sem a extens√£o de arquivo, mas pode ser sobreescrita ao definir [a propriedade `slug`](/pt-br/guides/content-collections/#definindo-slugs-customizados) no frontmatter de um arquivo.

#### `body`

**Dispon√≠vel para:** apenas cole√ß√µes `type: 'content'`
**Tipo:** `string`

Uma string contendo o body bruto e n√£o-compilado do documento Markdown ou MDX.

#### `render()`

**Dispon√≠vel para:** apenas cole√ß√µes `type: 'content'`
**Tipo:** `() => Promise<RenderedEntry>`

Uma fun√ß√£o para compilar dado documento Markdown ou MDX document para renderiza√ß√£o. Ela retorna as seguintes propriedades:

- `<Content />` - Um componente utilizado para renderizar os conte√∫dos do documento em um arquivo Astro.
- `headings` - A lista gerada de t√≠tulos, [imitando a utilidade `getHeadings()` do Astro](/pt-br/guides/markdown-content/#propriedades-exportadas) em importa√ß√µes Markdown e MDX.
- `remarkPluginFrontmatter ` - O objeto frontmatter modificado ap√≥s quaisquer [plugins remark ou rehype terem sido aplicados](/pt-br/guides/markdown-content/#modificando-frontmatter-programaticamente). Definido ao tipo `any`.

```astro
---
import { getEntryBySlug } from 'astro:content';
const entry = await getEntryBySlug('blog', 'entry-1');

const { Content, headings, remarkPluginFrontmatter } = await entry.render();
---
```

[Veja a se√ß√£o guia de `getCollection()`](/pt-br/guides/content-collections/#renderizando-conte√∫do-para-html) para exemplos completos de uso.

### Outros tipos de Cole√ß√µes de Conte√∫do

O m√≥dulo `astro:content` tamb√©m exporta os seguintes tipos para utilizar em seu projeto Astro:

#### `CollectionKey`

Uma uni√£o de strings de todos os nomes de cole√ß√µes definidas em seu arquivo `src/content/config.*`. Esse tipo pode ser √∫til ao definir uma fun√ß√£o gen√©rica que aceite o nome de qualquer cole√ß√£o.

```ts
import type { CollectionKey, getCollection } from 'astro:content';

async function getCollection(collection: CollectionKey) {
  return getCollection(collection);
}
```

#### `ContentCollectionKey`

Uma uni√£o de strings de todos os nomes de cole√ß√µes `type: 'content'` definidos em seu arquivo `src/content/config.*`.

#### `DataCollectionKey`

Uma uni√£o de strings de todos os nomes de cole√ß√µes `type: 'data'` definidoes em seu arquivo `src/content/config.*`.

#### `SchemaContext`

O objeto `context` que `defineCollection` passa para a constru√ß√£o do `schema`. Esse tipo pode ser √∫til ao criar schemas reutiliz√°veis para m√∫ltiplas cole√ß√µes.

Isso inclui as seguintes propriedades:

- `image` - O schema auxiliar `image()` que lhe permite [utilizar imagens locais em Cole√ß√µes de Conte√∫do](/pt-br/guides/images/#imagens-em-cole√ß√µes-de-conte√∫do)

```ts
import type { SchemaContext } from 'astro:content';

export const imageSchema = ({ image }: SchemaContext) =>
    z.object({
        image: image(),
        description: z.string().optional(),
    });

const blog = defineCollection({
    type: 'content',
    schema: ({ image }) => z.object({
        title: z.string(),
        permalink: z.string().optional(),
        image: imageSchema({ image }),
    }),
});
```

## Middleware (`astro:middleware`)

<p>
  <Since v="2.6.0" />
</p>

Middleware lhe permite interceptar chamadas e respostas e injetar comportamentos dinamicamente cada vez que uma p√°gina ou endpoint estiver prestes ser renderizada. Para funcionalidades e exemplos de uso, [veja nosso guia sobre middleware](/pt-br/guides/middleware/).

### `onRequest()`

Uma fun√ß√£o exportada obrigat√≥ria do arquivo `src/middleware.js` que ser√° chamada antes da renderiza√ß√£o de cada p√°gina ou rota da API. Ela aceita dois argumentos opcionais: [context](#contextlocals) e [next()](#next). `onRequest()` deve retornar uma `Response`: ou diretamente, ou chamando `next()`.

```js title="src/middleware.js"
export function onRequest(context, next) {
    // intercepta dados da chamada
    // opcionalmente, transforma a resposta
    // retorna uma `Response` diretamente, ou o resultado de chamar `next()`
    return next();
}
```

### `next()`

Uma fun√ß√£o que intercepta (l√™ e modifica) a resposta (`Response`) de uma requisi√ß√£o (`Request`) ou invoca o pr√≥ximo middleware na sequ√™ncia e retorna uma `Response`. Por exemplo, essa fun√ß√£o pode modificar o corpo HTML de uma resposta.

Esse √© um argumento opcional de `onRequest()`, e pode prover a `Response` que o middleware deve retornar.

### `sequence()`

Uma fun√ß√£o que aceita fun√ß√µes de middleware como argumentos, e os executar√° na ordem que foram passados.

```js title="src/middleware.js"
import { sequence } from "astro:middleware";

async function valida(_, next) {...}
async function autentica(_, next) {...}
async function sauda(_, next) {...}

export const onRequest = sequence(valida, autentica, sauda);
```

### `createContext()`

Uma API de baixo n√≠vel para criar um [`APIContext`](/pt-br/reference/api-reference/#contexto-de-endpoint) que pode ser utilizado pelo middleware Astro.

Essa fun√ß√£o pode ser usada por integra√ß√µes/adaptadores para executar programaticamente os middlewares Astro.

### `trySerializeLocals()`

Uma API de baixo n√≠vel que recebe qualquer valor e tenta retornar uma vers√£o serializada (uma string) desse valor. Se o valor n√£o puder ser serializado, essa fun√ß√£o ir√° lan√ßar um erro de runtime.


## Componentes Integrados

Astro inclui v√°rios componentes integrados para voc√™ utilizar em seus projetos. Todos os componentes integrados est√£o dispon√≠veis em arquivos `.astro` via `import {} from 'astro:components';`.

### `<Code />`

```astro 'theme="dark-plus"' /wrap\b/ /(inline) \/>/
---
import { Code } from 'astro:components';
---
<!-- Adicione syntax highlight de algum c√≥digo JavaScript. -->
<Code code={`const foo = 'bar';`} lang="js" />
<!-- Opcional: Customize seu tema. -->
<Code code={`const foo = 'bar';`} lang="js" theme="dark-plus" />
<!-- Opcional: Habilite quebra de texto. -->
<Code code={`const foo = 'bar';`} lang="js" wrap />
<!-- Optional: Exiba c√≥digo em linha. -->
<p>
  <Code code={`const foo = 'bar';`} lang="js" inline />
  vai ser renderizado em linha.
</p>
```

Este componente providencia syntax highlighting para blocos de c√≥digo em tempo de build (sem JavaScript no lado do cliente). O componente √© viabilizado internamente por Shiki e suporta todos os [temas](https://github.com/shikijs/shiki/blob/main/docs/themes.md) e [linguagens](https://github.com/shikijs/shiki/blob/main/docs/languages.md) populares. Al√©m disso, voc√™ pode adicionar temas e linguagens customizadas as passando para `theme` e `lang` respectivamente.

### `<Fragment />`

Um componente utilizado com [diretivas `set:*`](/pt-br/reference/directives-reference/#sethtml) para renderizar conte√∫do HTML sem nenhum elemento adicional em volta:

```astro title="src/components/SetHtml.astro" "Fragment"
---
const htmlString = '<p>Raw HTMl content</p>';
---
<Fragment set:html={htmlString} />
```

Veja mais sobre [o uso de fragmentos](/pt-br/core-concepts/astro-syntax/#fragmentos) na sintaxe do Astro.

### `<Prism />`

Para usar o componente highlighter `Prism`, primeiro **instale** o pacote `@astrojs/prism`:

<PackageManagerTabs>
  <Fragment slot="npm">
  ```shell
  npm install @astrojs/prism
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```shell
  pnpm add @astrojs/prism
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```shell
  yarn add @astrojs/prism
  ```
  </Fragment>
</PackageManagerTabs>

```astro
---
import { Prism } from '@astrojs/prism';
---
<Prism lang="js" code={`const foo = 'bar';`} />
```

Este componente providencia syntax highlighting de linguagens espec√≠ficas para blocos de c√≥digo aplicando as classes CSS do Prism. Note que **voc√™ precisa providenciar uma folha de estilos CSS do Prism** (ou utilizar sua pr√≥pria) para aparecer o syntax highlighting! Veja a [se√ß√£o de configura√ß√£o do Prism](/pt-br/guides/markdown-content/#configura√ß√£o-do-prism) para mais detalhes.

Veja a [lista de linguagens suportadas pelo Prism](https://prismjs.com/#supported-languages) aonde voc√™ pode ver o alias correspondente de uma linguagem. E, voc√™ tamb√©m pode mostrar seus blocos de c√≥digo Astro com `lang="astro"`!

## `<Image />`

```astro title="src/components/MeuComponente.astro"
---
// Importe o componente Image e a imagem
import { Image } from "astro:assets";
import minhaImagem from "../assets/minha_imagem.png"; // Imagem √© 1600x900
---

<!-- `alt` √© obrigat√≥rio no componente Image -->
<Image src={minhaImagem} alt="Uma descri√ß√£o da minha imagem." />
```

```html
<!-- Output -->
<!-- Image √© otimizado, atributos apropriados s√£o garantidos -->
<img
  src="/_astro/minha_imagem.hash.webp"
  width="1600"
  height="900"
  decoding="async"
  loading="lazy"
  alt="Uma descri√ß√£o da minha imagem."
/>
```

#### Propriedades

- src (obrigat√≥rio)
- alt (obrigat√≥rio)
- width e height (obrigat√≥rios para imagens em `public/` ou remotas)
- format
- quality
- densities
- widths

Adicionalmente √†s propriedades acima, o componente `<Image />` aceita todas as propriedades da tag HTML `<img>`.

Veja mais detalhes no [Guia de Imagens](/pt-br/guides/images/#image--astroassets).

### `<Picture />`

<Since v="3.3.0" />

Use o componente Astro integrado `<Picture />` para exibir imagens responsivas com m√∫ltiplos formatos e/ou tamanhos.

```astro title="src/pages/index.astro"
---
import { Picture } from "astro:assets";
import minhaImagem from "../assets/minha_imagem.png"; // Imagem √© 1600x900
---

<!-- `alt` √© obrigat√≥rio no componente Image -->
<Picture src={minhaImagem} formats={['avif', 'webp']} alt="Uma descri√ß√£o da minha imagem."  />
```

```html
<!-- Output -->
<picture>
  <source srcset="/_astro/minha_imagem.hash.avif" type="image/avif" />
  <source srcset="/_astro/minha_imagem.hash.webp" type="image/webp" />
  <img
    src="/_astro/minha_imagem.hash.png"
    width="1600"
    height="900"
    decoding="async"
    loading="lazy"
    alt="Uma descri√ß√£o da minha imagem."
  />
</picture>
```

Veja mais no [Guia de Imagens](/pt-br/guides/images/#picture-).

#### Propriedades

`<Picture />` aceita todas as propriedades do componente `<Image />`, juntamente com:

##### `formats`

Um array de formatos de imagem a serem utilizados nas tags `<source>`. Por padr√£o, isso √© configurado como `['webp']`.

##### `fallbackFormat`

Formato a ser usado como um valor de fallback para a tag `<img>`. Por padr√£o, √© configurado como `.png` para imagens est√°ticas, `.gif` para imagens animadas e `.svg` para arquivos SVG.

##### `pictureAttributes`

Use essa propriedade para aplicar atributos ao elemento externo `<picture>`. Atributos aplicados diretamente ao componente `<Picture />` ser√£o aplicados internamente ao elemento `<img>`, exceto aqueles usados para a transforma√ß√£o da imagem.

### `<Content />`

Um componente gen√©rico utilizado para renderizar o conte√∫do de uma [entrada de uma cole√ß√£o de conte√∫do](/pt-br/guides/content-collections/#o-que-s√£o-cole√ß√µes-de-conte√∫do).

Primeiro, busque por uma ou mais entradas utilizando `getCollection()` ou `getEntry()`. Com isso, a fun√ß√£o `entrada.render()` pode retornar o componente `<Content />` para ser utilizado em um arquivo de template `.astro`.

```astro title="src/pages/render-example.astro" {4, 7}
---
import { getEntry } from "astro:content";
const entrada = await getEntry('blog', 'post-1');
const { Content } = await entrada.render();
---
<p>Publicado em: {entrada.data.publicado.toDateString()}</p>
<Content />
```

### `<ViewTransitions />`

Opte por usar transi√ß√µes de visualiza√ß√£o on p√°ginas individuais importando e adicionando o componente de roteamento `<ViewTransitions />` ao `<head>` em cada p√°gina desejada.

```astro title="src/pages/index.astro" ins={2,7}
---
import { ViewTransitions } from "astro:transitions";
---
<html lang="en">
  <head>
    <title>Minha p√°gina inicial</title>
    <ViewTransitions />
  </head>
  <body>
    <h1>Bem-vindo ao meu site!</h1>
  </body>
</html>
```

Veja mais sobre como [controlar o roteamento](/pt-br/guides/view-transitions/#controle-de-roteamento) e [adicionar diretivas de transi√ß√£o](/pt-br/guides/view-transitions/#diretivas-de-transi√ß√£o) em elementos e componentes da p√°gina.

### `<Debug />`

```astro
---
import { Debug } from 'astro:components';
const objetoDoServidor = {
  a: 0,
  b: "string",
  c: {
    aninhado: "objeto"
  }
}
---
<Debug {objetoDoServidor} />
```

Este componente providencia uma forma de inspecionar valores no lado do cliente, sem utilizar JavaScript.


[canonical]: https://en.wikipedia.org/wiki/Canonical_link_element


---
title: Fa√ßa deploy do seu site Astro com Deno
description: Como fazer o deploy do seu site Astro para web utilizando Deno.
type: deploy
i18nReady: true
---

Voc√™ pode fazer deploy de um site Astro renderizado no servidor para o [Deno Deploy](https://deno.com/deploy), um sistema distribu√≠do que executa JavaScript, TypeScript e WebAssembly na edge globalmente.

Este guia inclui instru√ß√µes para fazer deploy para o Deno Deploy atrav√©s de GitHub Actions ou da CLI do Deno Deploy.

## Requisitos

Este guia assume que voc√™ j√° tem [Deno](https://deno.land/) instalado.

## Configura√ß√£o do Projeto

Seu projeto Astro pode ter deploy feito no [Deno Deploy][Deno adapter] como um site renderizado no lado do servidor (SSR). Deno Deploy n√£o suporta sites est√°ticos.

### Adaptador para SSR

Para habilitar SSR no seu projeto Astro para fazer deploy no Deno Deploy:

Adicione [o adaptador para Deno][Deno adapter] para habilitar SSR no seu projeto Astro com o seguinte comando `astro add`. Ele ir√° instalar o adaptador e fazer as mudan√ßas apropriadas para seu arquivo `astro.config.mjs` de uma vez.

```bash
npx astro add deno
```

Se voc√™ prefere instalar o adaptador manualmente, complete as duas etapas a seguir:

 1. Instale [o adaptador `@astrojs/deno`](https://github.com/withastro/astro/tree/main/packages/integrations/deno) nas depend√™ncias do seu projeto utilizando seu gerenciador de pacotes de prefer√™ncia. Se voc√™ estiver utilizando npm ou n√£o tiver certeza, execute isso no terminal:

    ```bash
      npm install @astrojs/deno
    ```

1. Atualize o arquivo de configura√ß√£o do seu projeto `astro.config.mjs` com as mudan√ßas abaixo.

    ```js ins={3,6-7}
    // astro.config.mjs
    import { defineConfig } from 'astro/config';
    import deno from '@astrojs/deno';

    export default defineConfig({
      output: 'server',
      adapter: deno(),
    });
    ```

    Em seguida, atualize seu script `preview` em `package.json` com as mudan√ßas abaixo.

    ```json del={8} ins={9}
    // package.json
    {
      // ...
      "scripts": {
        "dev": "astro dev",
        "start": "astro dev",
        "build": "astro build",
        "preview": "astro preview"
        "preview": "deno run --allow-net --allow-read --allow-env ./dist/server/entry.mjs"
      }
    }
    ```
    
    Voc√™ agora pode utilizar esse comando para pr√©-visualizar seu site Astro em produ√ß√£o localmente com Deno.
    
    ```bash
    npm run preview
    ```

## Como fazer o deploy

Voc√™ pode fazer o deploy para o Deno Deploy atrav√©s de GitHub Actions ou utilizando a CLI (interface de linha de comando) do Deno Deploy.

### Deploy por GitHub Actions

Se o seu projeto est√° armazenado no GitHub, o [website do Deno Deploy](https://dash.deno.com/) ir√° te guiar em como configurar o GitHub Actions para fazer deploy do seu site Astro.

1. Fa√ßa push do seu c√≥digo para um reposit√≥rio p√∫blico ou privado do GitHub.

1. Inicie sua sess√£o no [Deno Deploy](https://dash.deno.com/) com sua conta do GitHub e clique em [New Project](https://dash.deno.com).

1. Selecione seu reposit√≥rio, a branch do qual voc√™ quer que o deploy e selecione o modo **GitHub Action**. (Seu site Astro requer uma etapa de build e portanto n√£o pode utilizar o modo autom√°tico.)
   
1. No seu projeto Astro, crie um novo arquivo em `.github/workflows/deploy.yml` e copie o YAML abaixo. Isso √© similar ao YAML dado pelo Deno Deploy, com as etapas adicionais necess√°rias para seu site Astro.

    ```yaml
    name: Deploy
    on: [push]

    jobs:
      deploy:
        name: Deploy
        runs-on: ubuntu-latest
        permissions:
          id-token: write # Necess√°rio para se autenticar com o Deno Deploy
          contents: read # Necess√°rio para clonar o reposit√≥rio

        steps:
          - name: Clone repository
            uses: actions/checkout@v3

          # N√£o est√° utilizando npm? Mude `npm ci` para `yarn install` ou `pnpm i`
          - name: Install dependencies
            run: npm ci
    
          # N√£o est√° utilizando npm? Mude `npm run build` para `yarn build` ou `pnpm run build`
          - name: Build Astro
            run: npm run build

          - name: Upload to Deno Deploy
            uses: denoland/deployctl@v1
            with:
              project: my-deno-project # TODO: replace with Deno Deploy project name
              entrypoint: server/entry.mjs
              root: dist
    ```

1. Ap√≥s fazer o commit deste arquivo YAML e fazer o push para o GitHub na sua branch configurada para deploy, o deploy deve come√ßar automaticamente!

   Voc√™ pode verificar o progresso utilizando a aba "Actions" na p√°gina do seu reposit√≥rio do GitHub ou no [Deno Deploy](https://dash.deno.com).


### Deploy pela CLI

1. Instale a [CLI do Deno Deploy](https://deno.com/deploy/docs/deployctl).

    ```bash
    deno install --allow-read --allow-write --allow-env --allow-net --allow-run --no-check -r -f https://deno.land/x/deploy/deployctl.ts
    ```

1. Execute a etapa de build do Astro.

    ```bash
    npm run build
    ```

1. Execute `deployctl` para fazer o deploy!

   No comando abaixo, substitua `<TOKEN-DE-ACESSO>` com seu [Personal Access Token](https://dash.deno.com/user/access-tokens) e `<MEU-PROJETO-DENO>` com o nome do seu projeto do Deno Deploy.

    ```bash
    DENO_DEPLOY_TOKEN=<TOKEN-DE-ACESSO> deployctl deploy --project=<MEU-PROJETO-DENO> --no-static --include=./dist ./dist/server/entry.mjs
    ```
    
    Voc√™ pode ver todos os seus deploys em [Deno Deploy](https://dash.deno.com).

1. (Opcional) Para simplificar a build e o deploy em um s√≥ comando, adicione um script `deploy-deno` em `package.json`.

    ```json ins={9}
    // package.json
    {
      // ...
      "scripts": {
        "dev": "astro dev",
        "start": "astro dev",
        "build": "astro build",
        "preview": "deno run --allow-net --allow-read --allow-env ./dist/server/entry.mjs",
        "deno-deploy": "npm run build && deployctl deploy --project=<MY-DENO-PROJECT> --no-static --include=./dist ./dist/server/entry.mjs"
      }
    }
    ```
    
    Ent√£o voc√™ poder√° utilizar este comando para fazer a build e deploy do seu projeto Astro em uma etapa.
    
    ```bash
    DENO_DEPLOY_TOKEN=<TOKEN-DE-ACESSO> npm run deno-deploy
    ```


üìö Leia mais sobre [SSR no Astro](/pt-br/guides/server-side-rendering/).

[Deno adapter]: https://github.com/denoland/deno-astro-adapter

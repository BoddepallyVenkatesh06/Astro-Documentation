---
title: Busca de Dados
description: Aprenda como buscar dados remotamente com Astro utilizando a API fetch.
i18nReady: true
---

Arquivos `.astro` podem buscar dados remotamente para te ajudar a gerar suas p√°ginas.

## `fetch()` em Astro

Todos os [componentes Astro](/pt-br/core-concepts/astro-components/) tem acesso a [fun√ß√£o global `fetch()`](https://developer.mozilla.org/pt-BR/docs/Web/API/fetch) em seus scripts do componente para fazer requisi√ß√µes HTTP √† APIs usando a URL completa (e.x. https://example.com/api ou `Astro.url + "/api"`).

Essa chamada ao `fetch` ser√° executada em tempo de build, e os dados estar√£o dispon√≠veis ao template do componente para gerar HTML din√¢mico. Se o modo [SSR](/pt-br/guides/server-side-rendering/) estiver habilitado, quaisquer chamadas a `fetch()` ser√£o executadas em runtime.

üí° Aproveite-se do [**top-level await**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await#top_level_await) dentro do script do seu componente Astro.

üí° Passe os dados buscados para componentes Astro e de outros frameworks como props.

```astro /await fetch\\(.*?\\)/
---
// src/components/Usuario.astro
import Contato from '../components/Contato';
import Localizacao from '../components/Localizacao.astro';

const resposta = await fetch('https://randomuser.me/api/');
const dados = await resposta.json();
const usuarioAleatorio = dados.results[0];
---
<!-- Dados buscados em tempo de build podem ser renderizados no HTML -->
<h1>Usu√°rio</h1>
<h2>{usuarioAleatorio.name.first} {usuarioAleatorio.name.last}</h2>

<!-- Dados buscados em tempo de build podem ser passados aos componentes como props -->
<Contato client:load email={usuarioAleatorio.email} />
<Localizacao cidade={usuarioAleatorio.location.city} />
```

:::note
Lembre-se, todos os dados em componentes Astro s√£o buscados quando o componente √© renderizado.

Seu site Astro ap√≥s o deploy ir√° buscar os dados **uma vez, em tempo de build**. No desenvolvimento, voc√™ ver√° a busca de dados ao recarregar componentes. Se voc√™ precisa buscar dados m√∫ltiplas vezes no lado do cliente, utilize um [componente de framework](/pt-br/core-concepts/framework-components/) ou um [script no lado do cliente](/pt-br/guides/client-side-scripts/) em um componente Astro.
:::


## `fetch()` em Componentes de Frameworks

A fun√ß√£o `fetch()` tamb√©m est√° globalmente dispon√≠vel a qualquer [componente de framework](/pt-br/core-concepts/framework-components/):

```tsx title="src/components/Filmes.tsx" /await fetch\\(.*?\\)/
import type { FunctionalComponent } from 'preact';

const dados = await fetch('https://exemplo.com/filmes.json').then((resposta) =>
  resposta.json()
);

// Componentes que s√£o renderizados no momento de build tamb√©m fazem logs na interface de linha de comando.
// Quando renderizado com uma diretiva client:*, eles tamb√©m ir√£o fazer logs no console do navegador.
console.log(dados);

const Filmes: FunctionalComponent = () => {
// Exibe o resultado na p√°gina
  return <div>{JSON.stringify(dados)}</div>;
};

export default Filmes;
```


### Consultas GraphQL

Astro tamb√©m pode utilizar `fetch()` para consultar um servidor GraphQL com qualquer consulta GraphQL v√°lida.

```astro title="src/components/Filme.astro" "await fetch"
---
const resposta = await fetch("https://swapi-graphql.netlify.app/.netlify/functions/index",
  {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({
      query: `
        query getFilm ($id:ID!) {
          film(id: $id) {
            title
            releaseDate
          }
        }
      `,
      variables: {
        id: "ZmlsbXM6MQ==",
      },
    }),
  });

const json = await resposta.json();
const { film } = json.data;
---
<h1>Buscando informa√ß√µes sobre Star Wars: Uma Nova Esperan√ßa</h1>
<h2>T√≠tulo: {film.title}</h2>
<p>Ano: {film.releaseDate}</p>
```

## Busque de um CMS Headless

Componentes Astro podem buscar dados de seu CMS favorito e ent√£o renderiz√°-lo como o conte√∫do de sua p√°gina. Utilizando [rotas din√¢micas](/pt-br/core-concepts/routing/#rotas-din√¢micas), componentes podem at√© mesmo gerar p√°ginas com base no conte√∫do do seu CMS.

Veja nossos [Guias de CMS](/pt-br/guides/cms/) para mais detalhes em como integrar o Astro com CMSes headless incluindo Storyblok, Contentful e WordPress.

## Conte√∫do feitos pela comunidade

- [Criando uma aplica√ß√£o Full-Stack com Astro + GraphQL (Em Ingl√™s)](https://robkendal.co.uk/blog/how-to-build-astro-site-with-graphql/)
